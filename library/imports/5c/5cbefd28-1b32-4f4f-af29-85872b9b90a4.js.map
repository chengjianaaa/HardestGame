{"version":3,"sources":["../../../../assets/scripts/assets/scripts/game.js.js"],"names":["CreateHelper","require","UnitTools","cc","Class","extends","Component","properties","LevelsPrefab","default","type","Prefab","BulletPrefab","BingoBulletPrefab","FailAlertPrefab","LimitNumPrefab","StartTipsPrefab","SuccessAlertPrefab","TimeLablePrefab","start","InitConfig","LevelArray","Level","IsPause","RotationCircles","BulletCircles","RotationSpeed","LevelSpaceTime","IsCanTap","IsOver","length","GameStart","AnimationEnd","InitLevelUi","level","log","node","removeAllChildren","console","LevelPrefab","LevelUi","instantiate","circle","find","time_bg","limit_bg","LimitNum","TimeLabel","x","y","addChild","OffsetAngle","LimitTime","waitnum","TrunAngle","UpdateLimitNum","UpdateTimer","CreateBullet","time","timer","unschedule","getComponent","Label","string","isOver","GameContinue","bind","schedule","num","Name","RealPath","getRealPath","Sp","Sprite","changeSpriteFrameWithServerUrl","Bullet","TapHandle","StartTips","GamePause","resetLevel","self","SuccessAlert","active","NextBtn","setNodeClickEvent","GameOver","isCanTap","FailAlert","ResetBtn","isPause","update","dt","rotation"],"mappings":"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","file":"game.js.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\nvar CreateHelper = require(\"/CreatorHelper.js\");\nvar UnitTools = require(\"/UnitTools.js\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        LevelsPrefab: {\n            default: [],\n            type: cc.Prefab\n        }, //关卡表现Prefab\n        BulletPrefab: cc.Prefab,\n        BingoBulletPrefab: cc.Prefab,\n        FailAlertPrefab: cc.Prefab,\n        LimitNumPrefab: cc.Prefab,\n        StartTipsPrefab: cc.Prefab,\n        SuccessAlertPrefab: cc.Prefab,\n        TimeLablePrefab:cc.Prefab,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start() {\n        this.InitConfig();\n    },\n    //初始化相关关卡数据\n    InitConfig(LevelArray) {\n        //初始化关卡数据\n        if (!LevelArray) {\n            LevelArray = [\n                [6, 10,1.11],\n                [8, 45,2.22],\n                [9, 50,3.33],\n                [10,55,4.44],\n                [11,60,5.55],\n         \n            ];\n        }\n        this.LevelArray = LevelArray;\n        this.Level = 1; //游戏当前关卡\n        this.IsPause = false; //游戏当前事发后处于暂停状态,可通过gamePause方法暂停\n        this.RotationCircles = [];\n        this.BulletCircles = [];\n        this.RotationSpeed = 0.03;\n        this.LevelSpaceTime = 1;\n        this.IsCanTap = true;\n        this.IsOver = true;\n        this.length = this.LevelsPrefab.length;\n        this.GameStart()\n    },\n    AnimationEnd(){\n        this.InitLevelUi(this.level)\n    },\n    InitLevelUi(level) {\n        if (level > this.length) {\n            cc.log(\"全部通关啦\")\n            return\n        }\n\n        if (this.node){\n            this.node.removeAllChildren(true);\n        }\n        this.level = level;\n        var level = level - 1;\n        var LevelArray = this.LevelArray[level]\n        console.log(\"@@@InitLevelUi\", this.LevelsPrefab.length, level)\n        var LevelPrefab = this.LevelsPrefab[level]\n        var LevelUi = cc.instantiate(LevelPrefab);\n        this.circle = cc.find(\"circle\", LevelUi); \n        this.time_bg = cc.find(\"time_bg\", LevelUi);\n        this.limit_bg = cc.find(\"limit_bg\",LevelUi);\n        this.LimitNum = cc.instantiate(this.LimitNumPrefab)\n        this.TimeLabel = cc.instantiate(this.TimeLablePrefab)\n        this.TimeLabel.x = -357\n        this.TimeLabel.y = 455\n        if (LevelUi) {\n            this.LevelUi = LevelUi\n            this.node.addChild(LevelUi);\n        }\n        LevelUi.addChild(this.TimeLabel)\n        LevelUi.addChild(this.LimitNum)\n        this.OffsetAngle = LevelArray[2]\n        this.LimitTime = LevelArray[1]\n        this.waitnum = LevelArray[0]\n        cc.log(\"=======>\", this.LimitTime, this.waitnum, LevelArray)\n        this.TrunAngle = 0\n        this.UpdateLimitNum(0)\n        this.UpdateTimer(this.LimitTime)\n        this.CreateBullet()\n    },\n    //更新倒计时的\n    UpdateTimer(time){\n        if (this.timer) {\n            this.unschedule(this.timer)\n        }\n\n        //超时tick\n        this.TimeLabel.getComponent(cc.Label).string = time;\n        this.timer = function () {\n            time -= 1;\n            this.TimeLabel.getComponent(cc.Label).string = time;\n            if (time <= 0){\n                this.isOver = true;\n                if (this.timer) {\n                    this.unschedule(this.timer)\n                }\n                cc.log(\"时间到了\")\n                this.GameContinue()\n            }\n        }.bind(this);\n        this.schedule(this.timer, 1, this.LimitTime-1, 0);\n    },\n    //更新当前插中数字的\n    UpdateLimitNum(num){\n        if (this.LimitNum){\n            var Name = \"resources/limit_num/\"+num+\".png\"\n            var RealPath = CreateHelper.getRealPath(Name)\n            var Sp = this.LimitNum.getComponent(cc.Sprite)\n            CreateHelper.changeSpriteFrameWithServerUrl(Sp, RealPath)\n        }\n    },\n    //创建子弹\n    CreateBullet() {\n        var Bullet = cc.instantiate(this.BulletPrefab)\n        this.node.addChild(Bullet);\n    },\n    GameStart() {\n        this.level = 1;\n        this.IsPause = false;\n        this.IsOver = false;\n        this.IsCanTap = true;\n        this.TapHandle()//设置触摸\n        this.StartTips = cc.instantiate(this.StartTipsPrefab);\n        this.node.addChild(this.StartTips)\n    },\n    GamePause() {\n        this.IsCanTap = false;\n        this.IsPause = true;\n    },\n    GameContinue(resetLevel) {\n        var self = this;\n        self.IsPause = false;\n        self.IsCanTap = true;\n        if (this.IsOver || resetLevel) {\n            this.IsOver = false;\n        }\n        self.SuccessAlert = cc.instantiate(self.SuccessAlertPrefab)\n        self.node.addChild(self.SuccessAlert);\n        self.SuccessAlert.active = true\n        self.NextBtn = cc.find(\"next_btn\", self.SuccessAlert)\n        CreateHelper.setNodeClickEvent(self.NextBtn, function () {\n            self.level += 1;\n            cc.log(\"开始下一关\",self.level)\n            self.InitLevelUi(self.level)\n          })\n\n    },\n    GameOver() {\n        var self = this;\n        self.isOver = true;\n        self.isCanTap = false;\n        self.FailAlert = cc.instantiate(self.FailAlertPrefab)\n        self.node.addChild(self.FailAlert);\n        self.FailAlert.active = true\n        self.ResetBtn = cc.find(\"next_btn\", self.FailAlert)\n        CreateHelper.setNodeClickEvent(self.ResetBtn, function () {\n            self.FailAlert.active = false\n            self.InitLevelUi(1)\n          })\n    },\n    TapHandle(){\n        var self = this\n        if (self.node) {\n            CreateHelper.setNodeClickEvent(self.node, function () {\n                cc.log(\"======>\",self.isPause,self.IsCanTap,self.IsCanTap && !self.isPause)\n                if (self.IsCanTap && !self.isPause && !self.isOver) {\n                    self.level = self.level + 1\n                    self.InitLevelUi(self.level)\n                }\n            })\n        }\n    },\n    //更新位置\n    update(dt) {\n        if (!this.isPause && !this.isOver) {\n            this.TrunAngle += this.OffsetAngle\n            this.circle.rotation = this.TrunAngle;\n            if (this.TrunAngle >= 360) this.TrunAngle = 0;\n        }\n    },\n});"]}