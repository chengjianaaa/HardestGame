{"version":3,"sources":["game.js.js"],"names":["CreateHelper","require","UnitTools","cc","Class","extends","Component","properties","LevelsPrefab","default","type","Prefab","BulletPrefab","BingoBulletPrefab","FailAlertPrefab","LimitNumPrefab","StartTipsPrefab","SuccessAlertPrefab","TimeLablePrefab","start","InitConfig","LevelArray","Level","IsPause","RotationCircles","BulletCircles","RotationSpeed","LevelSpaceTime","IsCanTap","IsOver","length","GameStart","InitLevelUi","level","log","node","removeAllChildren","console","LevelPrefab","LevelUi","instantiate","circle","find","time_bg","limit_bg","LimitNum","TimeLabel","x","y","addChild","OffsetAngle","LimitTime","waitnum","TrunAngle","UpdateLimitNum","UpdateTimer","CreateBullet","time","timer","unschedule","getComponent","Label","string","isOver","GameOver","bind","schedule","num","Name","RealPath","getRealPath","Sp","Sprite","changeSpriteFrameWithServerUrl","Bullet","TapHandle","GamePause","GameContinue","resetLevel","self","isCanTap","FailAlert","active","NextBtn","setNodeClickEvent","isPause","update","dt","rotation"],"mappings":"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","file":"game.js.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\nvar CreateHelper = require(\"/CreatorHelper.js\");\nvar UnitTools = require(\"/UnitTools.js\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        LevelsPrefab: {\n            default: [],\n            type: cc.Prefab\n        }, //关卡表现Prefab\n        BulletPrefab: cc.Prefab,\n        BingoBulletPrefab: cc.Prefab,\n        FailAlertPrefab: cc.Prefab,\n        LimitNumPrefab: cc.Prefab,\n        StartTipsPrefab: cc.Prefab,\n        SuccessAlertPrefab: cc.Prefab,\n        TimeLablePrefab:cc.Prefab,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start() {\n        this.InitConfig();\n    },\n    //初始化相关关卡数据\n    InitConfig(LevelArray) {\n        //初始化关卡数据\n        if (!LevelArray) {\n            LevelArray = [\n                [6, 10,1.11],\n                [8, 45,2.22],\n                [9, 50,3.33],\n                [10,55,4.44],\n                [11,60,5.55],\n         \n            ];\n        }\n        this.LevelArray = LevelArray;\n        this.Level = 1; //游戏当前关卡\n        this.IsPause = false; //游戏当前事发后处于暂停状态,可通过gamePause方法暂停\n        this.RotationCircles = [];\n        this.BulletCircles = [];\n        this.RotationSpeed = 0.03;\n        this.LevelSpaceTime = 1;\n        this.IsCanTap = true;\n        this.IsOver = true;\n        this.length = this.LevelsPrefab.length;\n        this.GameStart()\n    },\n    InitLevelUi(level) {\n        if (level > this.length) {\n            cc.log(\"全部通关啦\")\n            return\n        }\n\n        if (this.node){\n            this.node.removeAllChildren(true);\n        }\n        this.level = level;\n\n        var level = level - 1;\n        var LevelArray = this.LevelArray[level]\n        console.log(\"@@@InitLevelUi\", this.LevelsPrefab.length, level)\n        var LevelPrefab = this.LevelsPrefab[level]\n        var LevelUi = cc.instantiate(LevelPrefab);\n        this.circle = cc.find(\"circle\", LevelUi); \n        this.time_bg = cc.find(\"time_bg\", LevelUi);\n        this.limit_bg = cc.find(\"limit_bg\",LevelUi);\n        this.LimitNum = cc.instantiate(this.LimitNumPrefab)\n        this.TimeLabel = cc.instantiate(this.TimeLablePrefab)\n        this.TimeLabel.x = -357\n        this.TimeLabel.y = 455\n        if (LevelUi) {\n            this.LevelUi = LevelUi\n            this.node.addChild(LevelUi);\n        }\n        LevelUi.addChild(this.TimeLabel)\n        LevelUi.addChild(this.LimitNum)\n        this.OffsetAngle = LevelArray[2]\n        this.LimitTime = LevelArray[1]\n        this.waitnum = LevelArray[0]\n        cc.log(\"=======>\", this.LimitTime, this.waitnum, LevelArray)\n        this.TrunAngle = 0\n        this.UpdateLimitNum(0)\n        this.UpdateTimer(this.LimitTime)\n        this.CreateBullet()\n    },\n    //更新倒计时的\n    UpdateTimer(time){\n        if (this.timer) {\n            this.unschedule(this.timer)\n        }\n\n        //超时tick\n        this.TimeLabel.getComponent(cc.Label).string = time;\n        this.timer = function () {\n            time -= 1;\n            this.TimeLabel.getComponent(cc.Label).string = time;\n            if (time <= 0){\n                this.isOver = true;\n                if (this.timer) {\n                    this.unschedule(this.timer)\n                }\n                cc.log(\"时间到了\")\n                this.GameOver()\n            }\n        }.bind(this);\n        this.schedule(this.timer, 1, this.LimitTime-1, 0);\n    },\n    //更新当前插中数字的\n    UpdateLimitNum(num){\n        if (this.LimitNum){\n            var Name = \"resources/limit_num/\"+num+\".png\"\n            var RealPath = CreateHelper.getRealPath(Name)\n            var Sp = this.LimitNum.getComponent(cc.Sprite)\n            CreateHelper.changeSpriteFrameWithServerUrl(Sp, RealPath)\n        }\n    },\n    //创建子弹\n    CreateBullet() {\n        var Bullet = cc.instantiate(this.BulletPrefab)\n        this.node.addChild(Bullet);\n    },\n    GameStart() {\n        this.level = 1;\n        this.IsPause = false;\n        this.IsOver = false;\n        this.IsCanTap = true;\n        this.InitLevelUi(this.level)\n        this.TapHandle()//设置触摸\n    },\n    GamePause() {\n        this.IsCanTap = false;\n        this.IsPause = true;\n    },\n    GameContinue(resetLevel) {\n        this.IsPause = false;\n        this.IsCanTap = true;\n        if (this.IsOver || resetLevel) {\n            this.IsOver = false;\n        }\n\n    },\n    GameOver() {\n        var self = this;\n        self.isOver = true;\n        self.isCanTap = false;\n        self.FailAlert = cc.instantiate(self.FailAlertPrefab)\n        self.node.addChild(self.FailAlert);\n        self.FailAlert.active = true\n        self.NextBtn = cc.find(\"next_btn\", self.FailAlert)\n        CreateHelper.setNodeClickEvent(self.NextBtn, function () {\n            self.FailAlert.active = false\n            self.InitLevelUi(1)\n          })\n    },\n    TapHandle(){\n        var self = this\n        if (self.node) {\n            CreateHelper.setNodeClickEvent(self.node, function () {\n                cc.log(\"======>\",self.isPause,self.IsCanTap,self.IsCanTap && !self.isPause)\n                if (self.IsCanTap && !self.isPause) {\n                    self.level = self.level + 1\n                    self.InitLevelUi(self.level)\n                }\n            })\n        }\n    },\n    //更新位置\n    update(dt) {\n        if (!this.isPause && !this.isOver) {\n            this.TrunAngle += this.OffsetAngle\n            this.circle.rotation = this.TrunAngle;\n            if (this.TrunAngle >= 360) this.TrunAngle = 0;\n        }\n    },\n});"]}